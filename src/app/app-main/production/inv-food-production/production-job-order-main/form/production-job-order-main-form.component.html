<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="d-flex justify-content-between">
        <div class="">
          <!-- <app-pagetitle [title]="'Production Job Order'"></app-pagetitle> -->
        </div>
        <div class="mt-2">
          <dx-button class="mr-2" [hint]="'Add New'" type="default" icon="plus" (onClick)="resetForm()"> </dx-button>
          <dx-button icon="refresh" type="success" [hint]="'Reload Form Fields'" (onClick)="FetchData()"></dx-button>
        </div>
      </div>
    </div>
  </div>

  <dx-form id="form" [formData]="productionJobOrderMainFormData" #productionJobOrderMainForm [showRequiredMark]="false" [colCountByScreen]="{ lg: 5, md: 4, sm: 3 }">
    <dxi-item
      cssClass="px-1 m-0"
      dataField="PlanCode"
      editorType="dxNumberBox"
      [editorOptions]="{
        placeholder: 'Doc no',
        min: 0
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="custom" [validationCallback]="validateNumberBox" message="Doc no is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      dataField="PlanDate"
      editorType="dxDateBox"
      [editorOptions]="{
        placeholder: 'Doc Date',
        displayFormat: 'dd-MMM-yyyy'
      }"
      cssClass="px-1 m-0"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Doc Date is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="InvProductionPlantId"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Plant/Feader',
        items: plantsList,
        valueExpr: 'Id',
        displayExpr: 'Description',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Plant/Feader is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="RefInvoiceNo"
      editorType="dxNumberBox"
      [editorOptions]="{
        placeholder: 'Manual Report Number',
        min: 0
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="custom" [validationCallback]="validateNumberBox" message="Manual Report Number is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="LotReference"
      editorType="dxTextBox"
      [editorOptions]="{
        placeholder: 'Other Ref'
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Other Ref is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="ProductionType"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Production Type',
        items: productionTypeList,
        valueExpr: 'label',
        displayExpr: 'label',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Production Type is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="PlanType"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Plant Type',
        items: planTypeList,
        valueExpr: 'label',
        displayExpr: 'label',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Plant Type is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="StartDate"
      editorType="dxDateBox"
      [editorOptions]="{
        placeholder: 'Start Date',
        displayFormat: 'dd-MMM-yyyy'
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Start Date is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      dataField="EndDate"
      cssClass="px-1 m-0"
      editorType="dxDateBox"
      [editorOptions]="{
        placeholder: 'End Date',
        displayFormat: 'dd-MMM-yyyy'
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="End Date is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      dataField="WorkInProccessAcId"
      cssClass="px-1 m-0"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Work In Process',
        dataSource: allAccountsList,
        valueExpr: 'Id',
        displayExpr: 'AccountTitle',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Work In Process is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      [colSpan]="2"
      dataField="WipItemId"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'WIP Item',
        dataSource: itemsList,
        valueExpr: 'Id',
        displayExpr: 'ItemName',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="WIP Item is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="PlanStatus"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Status',
        items: StatusList,
        valueExpr: 'label',
        displayExpr: 'label',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="required" message="Status is required"></dxi-validation-rule>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      dataField="FinishGoodsAcId"
      [colSpan]="2"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'Finish Goods Account',
        dataSource: allAccountsList,
        valueExpr: 'Id',
        displayExpr: 'AccountTitle',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
    </dxi-item>

    <dxi-item
      cssClass="px-1 m-0"
      [colSpan]="2"
      dataField="ByProductacId"
      editorType="dxSelectBox"
      [editorOptions]="{
        placeholder: 'By Production Acc',
        dataSource: allAccountsList,
        valueExpr: 'Id',
        displayExpr: 'AccountTitle',
        searchEnabled: true
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
    </dxi-item>
    <dxi-item
      cssClass="px-1 m-0"
      dataField="FinishGoodRate"
      editorType="dxNumberBox"
      [editorOptions]="{
        placeholder: 'Finish Average Rate',
        min: 0
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
      <dxi-validation-rule type="custom" [validationCallback]="validateNumberBox" message="Finish Average Rate is required"></dxi-validation-rule>
    </dxi-item>
    <dxi-item
      cssClass="px-1 m-0"
      [colSpan]="2"
      dataField="OtherInstructions"
      editorType="dxTextBox"
      [editorOptions]="{
        placeholder: 'Other Instructions'
      }"
    >
      <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
    </dxi-item>
  </dx-form>
  <div class="d-flex justify-content-end my-3">
    <div class="m-0 p-1">
      <dx-button type="success" text="{{ productionJobOrderMainFormData?.Id > 0 ? 'Update' : 'Save' }}" (onClick)="onSubmit()"></dx-button>
    </div>
    <div class="m-0 p-1">
      <dx-button type="danger" (onClick)="OnCancelClick()" text="Cancel"></dx-button>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <notification-popups [title]="'WARNING'" [type]="'warning'" (okClicked)="closeNotificationPopups($event)" [visibility]="warningPopupVisibility" [message]="message"></notification-popups>
      <notification-popups [title]="'ERROR'" [type]="'error'" (okClicked)="closeNotificationPopups($event)" [visibility]="errorPopupVisisble" [message]="message"></notification-popups>
      <notification-popups [title]="'Status'" [type]="'success'" (okClicked)="closeNotificationPopups($event)" [visibility]="successPopupVisible" [message]="message"></notification-popups>
    </div>
    <div class="col-md-12">
      <load-panel [message]="loadPanelMessage" [visibility]="loadPanelVisible"></load-panel>
    </div>
  </div>
</div>
