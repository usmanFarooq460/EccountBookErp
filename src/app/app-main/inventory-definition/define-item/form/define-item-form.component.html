<dx-popup
  [width]="WidthOfPopupWithGrid - GetPercentageValue(40, WidthOfPopupWithGrid)"
  [height]="HeightOfPopupWithGrid - GetPercentageValue(30, HeightOfPopupWithGrid)"
  [showTitle]="false"
  title="titleTemplate"
  [dragEnabled]="true"
  [closeOnOutsideClick]="false"
  [visible]="true"
  [animation]="{ hide: { type: 'slideOut', direction: 'right', duration: 1000 }, show: { type: 'slideIn', direction: 'left', duration: 1500 } }"
>
  <div *dxTemplate="let content of 'titleTemplate'"></div>

  <div *dxTemplate="let data of 'content'">
    <div class="row">
      <div class="col-md-12">
        <dx-form [formData]="ItemFormData" #ItemForm [showRequiredMark]="false" [colCountByScreen]="{ lg: 5, md: 3, sm: 2, xs: 2 }">
          <dxi-item
            cssClass="px-1 m-0"
            [colSpan]="2"
            dataField="ItemCategoryId"
            editorType="dxSelectBox"
            [editorOptions]="{
              placeholder: 'Item Category',
              items: catagoryList,
              valueExpr: 'Id',
              displayExpr: 'CategoryDescription',
              onValueChanged: GenerateCode,
              searchEnabled: true
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Item Catagory is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            dataField="ItemCode"
            cssClass="px-1 m-0"
            editorType="dxTextBox"
            [editorOptions]="{
              placeholder: 'Item Code',
              value: ItemCodeGenerate,
              readOnly: true
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Item Code is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            [colSpan]="2"
            dataField="ItemName"
            cssClass="px-1 m-0"
            editorType="dxTextBox"
            [editorOptions]="{
              placeholder: 'Item Name'
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Item Name is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            dataField="BaseUnitId"
            editorType="dxSelectBox"
            cssClass="px-1 m-0"
            [editorOptions]="{
              placeholder: 'Base Unit',
              items: baseUnitList,
              valueExpr: 'Id',
              displayExpr: 'UOMCode',
              searchEnabled: true
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Base Unit is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            [colSpan]="2"
            dataField="ItemTypeId"
            cssClass="px-1 m-0"
            editorType="dxSelectBox"
            [editorOptions]="{
              items: itemTypeList,
              valueExpr: 'Id',
              displayExpr: 'TypeDescription',
              searchEnabled: true,
              placeholder: 'Item Type'
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Item Type is required"></dxi-validation-rule>
          </dxi-item>
          <dxi-item
            dataField="ItemClassId"
            editorType="dxSelectBox"
            cssClass="px-1 m-0"
            [editorOptions]="{
              items: itemClassList,
              valueExpr: 'ClassId',
              displayExpr: 'ClassDescription',
              searchEnabled: true,
              placeholder: 'Item Class'
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Item Class is required"></dxi-validation-rule>
          </dxi-item>
          <dxi-item
            dataField="ItemGroupId"
            cssClass="px-1 m-0"
            editorType="dxSelectBox"
            [editorOptions]="{
              items: itemGroupList,
              valueExpr: 'GroupId',
              displayExpr: 'ItemGroupName',
              placeholder: 'Item Group',
              searchEnabled: true
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Uom Group is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            dataField="HSCode"
            cssClass="px-1 m-0"
            editorType="dxTextBox"
            [editorOptions]="{
              placeholder: 'HSCode'
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
          </dxi-item>

          <dxi-item
            dataField="ProductNo"
            editorType="dxTextBox"
            cssClass="px-1 m-0"
            [editorOptions]="{
              placeholder: 'Product No'
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
          </dxi-item>

          <dxi-item
            [colSpan]="2"
            dataField="PurchaseGLAC"
            cssClass="px-1 m-0"
            editorType="dxSelectBox"
            [editorOptions]="{
              placeholder: 'Purchase Account',
              dataSource: purchaseAcList,
              valueExpr: 'Id',
              displayExpr: 'AccountTitle',
              searchEnabled: true
            }"
          >
            <dxo-label text=" " location="top" [showColon]="false"></dxo-label>
            <dxi-validation-rule type="required" message="Purchase Account is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            [colSpan]="2"
            dataField="SaleGLAC"
            cssClass="px-1 m-0"
            editorType="dxSelectBox"
            [editorOptions]="{
              dataSource: saleAcList,
              valueExpr: 'Id',
              displayExpr: 'AccountTitle',
              searchEnabled: true,
              placeholder: 'Sale Account'
            }"
          >
            <dxo-label text=" " [showColon]="false" location="top"></dxo-label>
            <dxi-validation-rule type="required" message="Sale Account is required"></dxi-validation-rule>
          </dxi-item>

          <dxi-item
            [colSpan]="2"
            dataField="COGSGLAC"
            editorType="dxSelectBox"
            cssClass="px-1 m-0"
            [editorOptions]="{
              dataSource: cgsAcList,
              valueExpr: 'Id',
              displayExpr: 'AccountTitle',
              searchEnabled: true,
              placeholder: 'CGS Account'
            }"
          >
            <dxo-label text=" " [showColon]="false" location="top"></dxo-label>
            <dxi-validation-rule type="required" message="CGS Account is required"></dxi-validation-rule>
          </dxi-item>
          <dxi-item [colSpan]="2"  cssClass="px-1 m-0">
            <div *dxTemplate class="d-flex mt-2">
              <div class="dx-field-value" style="width: 140% !important">
                <dx-drop-down-box
                  [(value)]="selectedComapanyIds"
                  valueExpr="Id" displayExpr="CompName"
            
                  placeholder="Select Companies"
                  [dataSource]="dataSourcCompnay"
                  [showClearButton]="true"
                >
                  <div *dxTemplate="let data of 'content'">
                    <dx-data-grid
                      [dataSource]="dataSourcCompnay"
                      [columns]="['CompName', 'CompAddress']"
                      [selection]="{ mode: 'multiple' }"
                      [hoverStateEnabled]="true"
                      [paging]="{ enabled: true, pageSize: 5 }"
                      [filterRow]="{ visible: true }"
                      [scrolling]="{ mode: 'virtual' }"
                      [height]="280"
                      [(selectedRowKeys)]="selectedComapanyIds"
                    >
                    </dx-data-grid>
                  </div>
                </dx-drop-down-box>
              </div>
            </div>
          </dxi-item>
        </dx-form>
        <div class="text-right" style="margin-top: 20px">
          <dx-button icon="save" type="success" text="{{ itemParamsId > 0 ? 'Update' : 'Save' }}" (onClick)="onSave()"></dx-button>
          <dx-button icon="close" type="danger" class="ml-3" text="Close" (onClick)="close()"></dx-button>
        </div>
      </div>
    </div>
  </div>
</dx-popup>

<div class="col-md-12">
  <notification-popups [title]="'WARNING'" [type]="'warning'" (okClicked)="closeNotificationPopups($event)" [visibility]="warningPopupVisibility" [message]="message"></notification-popups>
  <notification-popups [title]="'ERROR'" [type]="'error'" (okClicked)="closeNotificationPopups($event)" [visibility]="errorPopupVisisble" [message]="message"></notification-popups>
  <notification-popups [title]="'Status'" [type]="'success'" (okClicked)="closeNotificationPopups($event)" [visibility]="successPopupVisible" [message]="message"></notification-popups>
</div>
<div class="col-md-12">
  <load-panel [message]="loadPanelMessage" [visibility]="loadPanelVisible"></load-panel>
</div>